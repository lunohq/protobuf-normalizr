!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports["protobuf-normalizr"]=e():n["protobuf-normalizr"]=e()}(this,function(){return function(n){function e(r){if(t[r])return t[r].exports;var u=t[r]={exports:{},id:r,loaded:!1};return n[r].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var t={};return e.m=n,e.c=t,e.p="",e(0)}([function(n,e){"use strict";function t(n,e){var t=!0;n:for(;t;){var r=n,u=e;a=i=o=l=void 0,t=!1;var a=u.split("."),i=a[0],o=a.slice(1).join("."),l=r[i];if(void 0!==l&&null!==l){if(o){n=l,e=o,t=!0;continue n}return!0}return!1}}function r(n){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1],t={},r={},u=d(n,t,r,e);return{entities:t,normalizations:r,result:u}}function u(n,e,t,r){var u=l(e);if(t.entities[u]){if(Array.isArray(n))return n.map(function(n){var e=t.entities[u][n];return g(e,u,n,t,void 0,r),e});var a=t.entities[u][n];return g(a,u,n,t,void 0,r)}}function a(n,e,t,r){var u=l(t);if(r.normalizations[u]){var a=r.normalizations[u][e];if(a)return a[n]}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r,e.denormalize=u,e.getNormalizations=a;var i=function(n){return n&&n.$type},o=function(n){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return n&&n.hasOwnProperty("id")&&null!==n.id||null!==e?!0:!1},l=function(n){return n.$type.fqn().toLowerCase()},s=function(n){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return e?e:n.get("id")},f=function(n,e,t,r){var u=arguments.length<=4||void 0===arguments[4]?null:arguments[4],a=e.get(n.name);if(null!==a&&(n.repeated&&a.length&&o(a[0],u)||o(a,u))){var i=l(e),f=s(e,u);r[i]||(r[i]={}),r[i][f]||(r[i][f]={});var m=r[i][f];n.repeated?(m[n.name]||(m[n.name]=[]),a.map(function(e){m[n.name].push(e.id),d(e,t,r)}),e.set(n.name,null)):o(a)&&(m[n.name]=a.id,d(a,t,r),e.set(n.name,null))}},m=function(n,e,t){var r=arguments.length<=3||void 0===arguments[3]?null:arguments[3];return n.$type._fields.map(function(u){f(u,n,e,t,r)}),n},v=function(n,e,t){var r=n.map(function(n){return d(n,e,t)});return r},c=function(n,e,t){var r=arguments.length<=3||void 0===arguments[3]?null:arguments[3],u=l(n),a=s(n,r);return e[u]||(e[u]={}),e[u][a]=n,m(n,e,t,r),a},d=function(n,e,t){var r=arguments.length<=3||void 0===arguments[3]?null:arguments[3];return i(n)&&o(n,r)?c(n,e,t,r):i(n)?m(n,e,t):n instanceof Array?v(n,e,t):n},g=function p(n,e,r,u){var a=arguments.length<=4||void 0===arguments[4]?null:arguments[4],i=arguments.length<=5||void 0===arguments[5]?null:arguments[5],o=n.$type.clazz.decode(n.encode());if(!u.normalizations[e])return o;var l=o.$type._fieldsByName,s=u.normalizations[e][r],f=function(n){var t=s[n],r=l[n].resolvedType.fqn().toLowerCase();if(r===a)return"continue";if(t instanceof Array)o.set(n,[]),t.map(function(t){var i=u.entities[r][t];o[n].push(p(i,r,t,u,a=e))});else{var i=u.entities[r][t];o.set(n,p(i,r,t,u,a=e))}};for(var m in s){f(m)}if(i&&i.length>0){var v=!0,c=!1,d=void 0;try{for(var g,y=i[Symbol.iterator]();!(v=(g=y.next()).done);v=!0){var m=g.value;if(!t(o,m))return null}}catch(h){c=!0,d=h}finally{try{!v&&y["return"]&&y["return"]()}finally{if(c)throw d}}}return o}}])});
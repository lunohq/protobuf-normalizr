!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports["protobuf-normalizr"]=e():n["protobuf-normalizr"]=e()}(this,function(){return function(n){function e(r){if(t[r])return t[r].exports;var u=t[r]={exports:{},id:r,loaded:!1};return n[r].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var t={};return e.m=n,e.c=t,e.p="",e(0)}([function(n,e){"use strict";function t(n){return n&&n.$type}function r(n){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return n&&n.hasOwnProperty("id")&&null!==n.id||null!==e?!0:!1}function u(n){return n.$type.fqn().toLowerCase()}function a(n){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return e?e:n.get("id")}function i(n,e,t,i){var o=arguments.length<=4||void 0===arguments[4]?null:arguments[4],s=e.get(n.name);if(null!==s&&(n.repeated&&s.length&&r(s[0],o)||r(s,o))){var l=u(e),m=a(e,o);i[l]||(i[l]={}),i[l][m]||(i[l][m]={});var v=i[l][m];n.repeated?(v[n.name]||(v[n.name]=[]),s.map(function(e){v[n.name].push(e.id),f(e,t,i)}),e.set(n.name,null)):r(s)&&(v[n.name]=s.id,f(s,t,i),e.set(n.name,null))}}function o(n,e,t){var r=arguments.length<=3||void 0===arguments[3]?null:arguments[3];return n.$type._fields.map(function(u){i(u,n,e,t,r)}),n}function s(n,e,t){var r=n.map(function(n){return f(n,e,t)});return r}function l(n,e,t){var r=arguments.length<=3||void 0===arguments[3]?null:arguments[3],i=u(n),s=a(n,r);return e[i]||(e[i]={}),e[i][s]=n,o(n,e,t,r),s}function f(n,e,u){var a=arguments.length<=3||void 0===arguments[3]?null:arguments[3];return t(n)&&r(n,a)?l(n,e,u,a):t(n)?o(n,e,u):n instanceof Array?s(n,e,u):n}function m(n,e,t,r){var u=arguments.length<=4||void 0===arguments[4]?null:arguments[4],a=arguments.length<=5||void 0===arguments[5]?null:arguments[5],i=n.$type.clazz.decode(n.encode());if(r.normalizations[e]){var o=i.$type._fieldsByName,s=r.normalizations[e][t],l=function(n){var t=s[n];if(!o[n].resolvedType)return"continue";var a=o[n].resolvedType.fqn().toLowerCase();if(a===u)return"continue";if(t instanceof Array)i.set(n,[]),t.map(function(t){var o=r.entities[a][t];i[n].push(m(o,a,t,r,u=e))});else{var l=r.entities[a][t];i.set(n,m(l,a,t,r,u=e))}};for(var f in s){l(f)}}return a&&!a(i,e,t)?null:i}function v(n){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1],t={},r={},u=f(n,t,r,e);return{entities:t,normalizations:r,result:u}}function g(n,e,t){var r=arguments.length<=3||void 0===arguments[3]?null:arguments[3],a=u(e);if(t.entities[a]){if(!Array.isArray(n)){var i=t.entities[a][n];if(!i)return;return m(i,a,n,t,void 0,r)}var o=function(){var e=[],u=n.every(function(n){var u=t.entities[a][n],i=m(u,a,n,t,void 0,r),o=!0;return r&&(o=r(i,a,n)),o&&e.push(i),o});return u?{v:e}:{v:null}}();return"object"==typeof o?o.v:void 0}}function d(n,e,t,r){var a=u(t);if(r.normalizations&&r.normalizations[a]){var i=r.normalizations[a][e];if(i)return i[n]}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=v,e.denormalize=g,e.getNormalizations=d}])});